(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7797e960"],{"1c39":function(e,t,i){},"2d5d":function(e,t,i){"use strict";function a(e,t){var i=new FileReader;i.readAsDataURL(e.raw),i.onload=function(e){console.log(e),t(e.target.result)}}i.d(t,"a",function(){return a})},"35f4":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"top-text"},[e._v("请上传统一尺寸的图片，否则以首张图片尺寸为准(限10张)")]),e._v(" "),i("div",{staticClass:"imageListWrapper"},[i("transition-group",{class:["el-upload-list","el-upload-list--picture-card"],attrs:{tag:"ul",name:"el-list-test"}},e._l(e.dialogImageUrl,function(t,a){return i("li",{key:t.url+a,staticClass:"imageItem"},[i("ImageView",{attrs:{src:t.url}}),e._v(" "),i("div",{staticClass:"itemOperation"},[i("span",{on:{click:function(t){return e.removeImage(a)}}},[i("i",{staticClass:"el-icon-delete"})])])],1)}),0),e._v(" "),i("el-upload",{ref:"foreignPersonUploadItem",staticClass:"avatar-image",attrs:{action:"''","auto-upload":!1,multiple:"","list-type":"picture-card","on-change":e.handleAvatarSuccess,"on-preview":e.handlePictureCardPreview,"on-remove":e.handleRemove,"file-list":e.dialogImageUrl,"on-exceed":e.handleExceed,limit:10,"show-file-list":!1,"before-remove":e.beforeRemove}},[i("div",{staticClass:"container-text"},[i("svg-icon",{attrs:{"icon-class":"camera"}}),e._v(" "),i("div",[e._v("添加产品亮点图")]),e._v(" "),i("div",[e._v("推荐尺寸900px*1250px")])],1)])],1),e._v(" "),i("el-dialog",{staticClass:"image-list",attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("img",{attrs:{width:"100%",src:e.dialogImageUrlReview,alt:""}})]),e._v(" "),i("el-row",[i("el-button",{attrs:{type:"primary"},on:{click:e.submitBtn}},[e._v("保存")])],1)],1)},n=[],r=i("c4c8"),o=i("2d5d"),l=i("53fe"),s=i.n(l),c=i("f499"),u=i.n(c);function d(e,t,i){var a=JSON.parse(u()(e)),n=e[t],r=e[i];return a[t]=r,a[i]=n,a}var g={data:function(){return{dialogImageUrl:[],dialogImageUrlReview:"",dialogVisible:!1,listQuery:{product_id:""},filePic:[],sortable:null,oldList:[],newList:[]}},computed:{addData:function(){var e=[];for(var t in this.dialogImageUrl){var i=this.dialogImageUrl[t];i.isNew&&e.push(i.url)}return e}},created:function(){var e=this;this.$store.dispatch("product/getProductInfo",function(t){e.listQuery.product_id=t.id,e.getPicList()})},mounted:function(){},methods:{removeImage:function(e){var t=this;this.$confirm("删除后将不可恢复。","确定删除？",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(r["g"])({introduce_pic:t.dialogImageUrl[e].url,id:t.listQuery.product_id}).then(function(i){1e3===i.code?(t.$message({message:"删除成功",type:"success"}),t.dialogImageUrl.splice(e,1)):t.$message({message:i.message,type:"success"})})}).catch(function(){})},submit:function(){var e=this;Object(r["E"])({id:this.listQuery.product_id,introduce_pic_arr:this.addData}).then(function(t){1e3===t.code?Object(r["l"])({id:e.listQuery.product_id}).then(function(t){var i=t.data.introduce_pic.map(function(e){return{url:e}});e.dialogImageUrl=[],e.dialogImageUrl=i,e.dialogImageUrl.length>=10?document.querySelector(".avatar-image .el-upload--picture-card").style.display="none":document.querySelector(".avatar-image .el-upload--picture-card").style.display="inline-block"}):e.$message({message:t.message,type:"error"})})},submitBtn:function(){this.$message({message:"提交成功",type:"success"})},getPicList:function(){var e=this;Object(r["l"])({id:this.listQuery.product_id}).then(function(t){var i=t.data.introduce_pic.map(function(e){return{url:e}});e.dialogImageUrl=i,e.dialogImageUrl.length>=10?document.querySelector(".avatar-image .el-upload--picture-card").style.display="none":document.querySelector(".avatar-image .el-upload--picture-card").style.display="inline-block",e.$nextTick(function(){e.setSort()})})},handleExceed:function(e,t){this.$message.warning("当前限制选择 10 个文件，本次选择了 ".concat(e.length," 个文件，共选择了 ").concat(e.length+t.length," 个文件"))},beforeRemove:function(e,t){},handleRemove:function(e,t){console.log(t,"删除成功")},handlePictureCardPreview:function(e){this.dialogImageUrlReview=e.url,this.dialogVisible=!0},handleAvatarSuccess:function(e,t){var i=this;t.length>=10&&(document.querySelector(".avatar-image .el-upload--picture-card").style.display="none"),Object(o["a"])(e,function(e){i.dialogImageUrl.push({url:e,isNew:!0}),i.submit()})},setSort:function(){var e=this,t=this.$el.querySelector(".imageListWrapper > ul");this.sortable=s.a.create(t,{ghostClass:"sortable-ghost",setData:function(e){e.setData("Text","")},onEnd:function(t){e.dialogImageUrl=d(e.dialogImageUrl,t.oldIndex,t.newIndex);var i=e.dialogImageUrl.map(function(e){return e.url});Object(r["t"])({id:e.listQuery.product_id,introduce_pic_arr:i}).then(function(e){console.log(e)})}})}}},m=g,p=(i("3b81"),i("ae74"),i("2877")),f=Object(p["a"])(m,a,n,!1,null,"6d86a4c2",null);t["default"]=f.exports},"3b81":function(e,t,i){"use strict";var a=i("1c39"),n=i.n(a);n.a},"8be8":function(e,t,i){},a21f:function(e,t,i){var a=i("584a"),n=a.JSON||(a.JSON={stringify:JSON.stringify});e.exports=function(e){return n.stringify.apply(n,arguments)}},ae74:function(e,t,i){"use strict";var a=i("8be8"),n=i.n(a);n.a},f499:function(e,t,i){e.exports=i("a21f")}}]);